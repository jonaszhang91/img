# ip路由

## IP路由实现

三层设备 收到一个数据包，会查看自身的路由表，根据查表的结果：

    1. 有明确路由且知道下一跳，就会按照改条目转发。

    2. 无关于该目标网段的路由，直接丢弃。

## 路由

1. 路由是知道报文转发的路径信息，通过路由可以确认转发ip 报文的路径

2. 路由设备是依据路由转发报文到目的网段的网络设备，最常见的路由设备：路由器

3. 路由设备维护着一张路由表，保存着路由信息。

![](/IP路由/路由.png)


## 直连路由

    1. 正确配置ip地址且对方处于同一网段(以太网适用，p2p除外)
    2. 接口状态正常，up（协议，物理）

## 路由信息
![](/IP路由/路由信息.png)


路由中包含一下信息：
    目标网络： 标识目的网段
    掩码： 与目的地址共同标识一个网段
    出接口： 数据包被路由后离开本路由的接口
    下一跳： 路由器转发到目的网段的数据包所使用的下一跳地址


## 路由信息获取方式

1. 直连路由
2. 静态路由
3. 动态路由
![](/IP路由/路由信息获取方式.png)

## 路由表

### 查看路由表
    命令 dis ip rou （简写）
    display ip routing-table(全称)
![](/IP路由/路由表查看.png)

## 路由优先级

### 优先级和度量值的比较
    1. 对于同一路由前缀，如果从不同的路由协议学习到，先比较优先级 PRE，越小优先级越高
    2. 对于同一路由前缀，如果从相同的协议学习到，此时优先级一样，只能比较cost值，数值越小越优先


## 度量衡Cost

![](/IP路由/cost.png)

## 路由优先级比较
![](/IP路由/路由比较优先级.png)
RTA 通过动态路由协议 ospf 和手动配置的方式都发现了到达10.0.0.0/30 的路由

此时会比较两条路由的优先级，优选优先级比较小的路由

每一种路由协议都有相应优先级

ospf 拥有更优的优先级，因此通过ospf学习到的路由器被添加到路由表中


# 静态分配和动态分配 